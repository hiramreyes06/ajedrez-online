(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{RPs8:function(e,t,i){"use strict";i.r(t),i.d(t,"PartidaModule",function(){return Pe});var a=i("ofXK"),s=i("mrSG"),n=i("quSY"),o=i("ffzF"),c=i("wOSr"),r=i("3Pt+"),l=i("iELJ"),h=i("fXoL"),d=i("jU0p"),m=i("wUqA"),u=i("jDhr"),p=i("Dxy4"),b=i("FKr1"),g=i("8LU1"),k=i("R1ws"),f=i("u47x"),x=i("CtHx");const I=["input"],y=function(){return{enterDuration:150}},v=["*"],R=new h.r("mat-radio-default-options",{providedIn:"root",factory:function(){return{color:"accent"}}});let _=0;const A={provide:r.i,useExisting:Object(h.U)(()=>z),multi:!0};class C{constructor(e,t){this.source=e,this.value=t}}const E=new h.r("MatRadioGroup");let P=(()=>{class e{constructor(e){this._changeDetector=e,this._value=null,this._name="mat-radio-group-"+_++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new h.o}get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition="before"===e?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=Object(g.c)(e),this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=Object(g.c)(e),this._markRadiosForCheck()}ngAfterContentInit(){this._isInitialized=!0}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(e=>{e.checked=this.value===e.value,e.checked&&(this._selected=e)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new C(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(h.h))},e.\u0275dir=h.Gb({type:e,inputs:{name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:"disabled",required:"required",color:"color"},outputs:{change:"change"}}),e})(),z=(()=>{class e extends P{}return e.\u0275fac=function(t){return B(t||e)},e.\u0275dir=h.Gb({type:e,selectors:[["mat-radio-group"]],contentQueries:function(e,t,i){if(1&e&&h.Eb(i,w,!0),2&e){let e;h.mc(e=h.Zb())&&(t._radios=e)}},hostAttrs:["role","radiogroup",1,"mat-radio-group"],exportAs:["matRadioGroup"],features:[h.zb([A,{provide:E,useExisting:e}]),h.xb]}),e})();const B=h.Tb(z);class O{constructor(e){this._elementRef=e}}const L=Object(b.p)(Object(b.t)(O));let Y=(()=>{class e extends L{constructor(e,t,i,a,s,n,o,c){super(t),this._changeDetector=i,this._focusMonitor=a,this._radioDispatcher=s,this._animationMode=n,this._providerOverride=o,this._uniqueId="mat-radio-"+ ++_,this.id=this._uniqueId,this.change=new h.o,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=e,c&&(this.tabIndex=Object(g.f)(c,0)),this._removeUniqueSelectionListener=s.listen((e,t)=>{e!==this.id&&t===this.name&&(this.checked=!1)})}get checked(){return this._checked}set checked(e){const t=Object(g.c)(e);this._checked!==t&&(this._checked=t,t&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!t&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),t&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(e){this._setDisabled(Object(g.c)(e))}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){this._required=Object(g.c)(e)}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(e){this._color=e}get inputId(){return(this.id||this._uniqueId)+"-input"}focus(e,t){t?this._focusMonitor.focusVia(this._inputElement,t,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new C(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(e){e.stopPropagation()}_onInputChange(e){e.stopPropagation();const t=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),t&&this.radioGroup._emitChangeEvent())}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(P),h.Lb(h.l),h.Lb(h.h),h.Lb(f.e),h.Lb(x.d),h.Lb(String),h.Lb(void 0),h.Lb(String))},e.\u0275dir=h.Gb({type:e,viewQuery:function(e,t){if(1&e&&h.Dc(I,!0),2&e){let e;h.mc(e=h.Zb())&&(t._inputElement=e.first)}},inputs:{id:"id",checked:"checked",value:"value",labelPosition:"labelPosition",disabled:"disabled",required:"required",color:"color",name:"name",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"]},outputs:{change:"change"},features:[h.xb]}),e})(),w=(()=>{class e extends Y{constructor(e,t,i,a,s,n,o,c){super(e,t,i,a,s,n,o,c)}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(E,8),h.Lb(h.l),h.Lb(h.h),h.Lb(f.e),h.Lb(x.d),h.Lb(k.a,8),h.Lb(R,8),h.Wb("tabindex"))},e.\u0275cmp=h.Fb({type:e,selectors:[["mat-radio-button"]],hostAttrs:[1,"mat-radio-button"],hostVars:17,hostBindings:function(e,t){1&e&&h.Yb("focus",function(){return t._inputElement.nativeElement.focus()}),2&e&&(h.Bb("tabindex",null)("id",t.id)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),h.Db("mat-radio-checked",t.checked)("mat-radio-disabled",t.disabled)("_mat-animation-noopable","NoopAnimations"===t._animationMode)("mat-primary","primary"===t.color)("mat-accent","accent"===t.color)("mat-warn","warn"===t.color))},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matRadioButton"],features:[h.xb],ngContentSelectors:v,decls:13,vars:19,consts:[[1,"mat-radio-label"],["label",""],[1,"mat-radio-container"],[1,"mat-radio-outer-circle"],[1,"mat-radio-inner-circle"],["type","radio",1,"mat-radio-input","cdk-visually-hidden",3,"id","checked","disabled","tabIndex","required","change","click"],["input",""],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mat-radio-label-content"],[2,"display","none"]],template:function(e,t){if(1&e&&(h.hc(),h.Rb(0,"label",0,1),h.Rb(2,"span",2),h.Mb(3,"span",3),h.Mb(4,"span",4),h.Rb(5,"input",5,6),h.Yb("change",function(e){return t._onInputChange(e)})("click",function(e){return t._onInputClick(e)}),h.Qb(),h.Rb(7,"span",7),h.Mb(8,"span",8),h.Qb(),h.Qb(),h.Rb(9,"span",9),h.Rb(10,"span",10),h.yc(11,"\xa0"),h.Qb(),h.gc(12),h.Qb(),h.Qb()),2&e){const e=h.nc(1);h.Bb("for",t.inputId),h.Ab(5),h.ic("id",t.inputId)("checked",t.checked)("disabled",t.disabled)("tabIndex",t.tabIndex)("required",t.required),h.Bb("name",t.name)("value",t.value)("aria-label",t.ariaLabel)("aria-labelledby",t.ariaLabelledby)("aria-describedby",t.ariaDescribedby),h.Ab(2),h.ic("matRippleTrigger",e)("matRippleDisabled",t._isRippleDisabled())("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",h.jc(18,y)),h.Ab(2),h.Db("mat-radio-label-before","before"==t.labelPosition)}},directives:[b.j],styles:[".mat-radio-button{display:inline-block;-webkit-tap-highlight-color:transparent;outline:0}.mat-radio-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;display:inline-flex;align-items:center;white-space:nowrap;vertical-align:middle;width:100%}.mat-radio-container{box-sizing:border-box;display:inline-block;position:relative;width:20px;height:20px;flex-shrink:0}.mat-radio-outer-circle{box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;transition:border-color ease 280ms;width:20px;border-width:2px;border-style:solid;border-radius:50%}._mat-animation-noopable .mat-radio-outer-circle{transition:none}.mat-radio-inner-circle{border-radius:50%;box-sizing:border-box;display:block;height:20px;left:0;position:absolute;top:0;transition:transform ease 280ms,background-color ease 280ms;width:20px;transform:scale(0.001)}._mat-animation-noopable .mat-radio-inner-circle{transition:none}.mat-radio-checked .mat-radio-inner-circle{transform:scale(0.5)}.cdk-high-contrast-active .mat-radio-checked .mat-radio-inner-circle{border:solid 10px}.mat-radio-label-content{-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto;display:inline-block;order:0;line-height:inherit;padding-left:8px;padding-right:0}[dir=rtl] .mat-radio-label-content{padding-right:8px;padding-left:0}.mat-radio-label-content.mat-radio-label-before{order:-1;padding-left:0;padding-right:8px}[dir=rtl] .mat-radio-label-content.mat-radio-label-before{padding-right:0;padding-left:8px}.mat-radio-disabled,.mat-radio-disabled .mat-radio-label{cursor:default}.mat-radio-button .mat-radio-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-radio-button .mat-radio-ripple .mat-ripple-element:not(.mat-radio-persistent-ripple){opacity:.16}.mat-radio-persistent-ripple{width:100%;height:100%;transform:none}.mat-radio-container:hover .mat-radio-persistent-ripple{opacity:.04}.mat-radio-button:not(.mat-radio-disabled).cdk-keyboard-focused .mat-radio-persistent-ripple,.mat-radio-button:not(.mat-radio-disabled).cdk-program-focused .mat-radio-persistent-ripple{opacity:.12}.mat-radio-persistent-ripple,.mat-radio-disabled .mat-radio-container:hover .mat-radio-persistent-ripple{opacity:0}@media(hover: none){.mat-radio-container:hover .mat-radio-persistent-ripple{display:none}}.mat-radio-input{bottom:0;left:50%}.cdk-high-contrast-active .mat-radio-disabled{opacity:.5}\n"],encapsulation:2,changeDetection:0}),e})(),D=(()=>{class e{}return e.\u0275mod=h.Jb({type:e}),e.\u0275inj=h.Ib({factory:function(t){return new(t||e)},imports:[[b.k,b.g],b.g]}),e})();var S=i("Q2Ze"),X=i("e6WT"),N=i("Tj54");function M(e,t){if(1&e&&(h.Rb(0,"p"),h.yc(1),h.Qb()),2&e){const e=h.cc(2);h.Ab(1),h.zc(e.getNombre()===e.data.ganador?"Tu eres el ganador \ud83d\ude0e":"El ganador es "+e.data.ganador+" \ud83e\udd16")}}function j(e,t){if(1&e&&(h.Rb(0,"p"),h.yc(1),h.Qb()),2&e){const e=h.cc(2);h.Ab(1),h.Bc("",e.partidaInvitacion.jugador.username," te pide la revancha ",e.partidaInvitacion.tiempo," minutos")}}function V(e,t){if(1&e){const e=h.Sb();h.Rb(0,"button",6),h.Yb("click",function(){return h.oc(e),h.cc(2).jugarPartida(2)}),h.yc(1," Pedir revancha "),h.Qb()}if(2&e){const e=h.cc(2);h.ic("disabled",!e.pedirRevancha)}}function T(e,t){if(1&e){const e=h.Sb();h.Rb(0,"div",1),h.Rb(1,"p"),h.yc(2),h.Qb(),h.xc(3,M,2,1,"p",3),h.xc(4,j,2,2,"p",3),h.xc(5,V,2,1,"button",4),h.Rb(6,"button",5),h.Yb("click",function(){return h.oc(e),h.cc().aceptarRevanchaButton()}),h.yc(7," Aceptar revancha "),h.Qb(),h.Qb()}if(2&e){const e=h.cc();h.Ab(2),h.zc(e.data.resultado),h.Ab(1),h.ic("ngIf",e.data.ganador),h.Ab(1),h.ic("ngIf",e.aceptarRevancha),h.Ab(1),h.ic("ngIf",!e.aceptarRevancha),h.Ab(1),h.ic("disabled",!e.aceptarRevancha)}}function q(e,t){if(1&e&&(h.Rb(0,"p"),h.yc(1),h.Qb()),2&e){const e=h.cc(2);h.Ab(1),h.Bc("",e.partidaInvitacion.jugador.username," te invita a una partida de ",e.partidaInvitacion.tiempo," minutos")}}function Q(e,t){if(1&e){const e=h.Sb();h.Rb(0,"div",1),h.Rb(1,"p"),h.yc(2,"Elige el timpo que quieres jugar"),h.Qb(),h.Rb(3,"mat-radio-group",7),h.Rb(4,"mat-radio-button",8),h.yc(5,"3 minutos"),h.Qb(),h.Rb(6,"mat-radio-button",8),h.yc(7,"5 minutos"),h.Qb(),h.Rb(8,"mat-radio-button",8),h.yc(9,"10 minutos"),h.Qb(),h.Qb(),h.Rb(10,"button",9),h.Yb("click",function(){return h.oc(e),h.cc().jugarPartida(1)}),h.yc(11," Buscar oponente "),h.Qb(),h.Rb(12,"p"),h.Rb(13,"mat-form-field",10),h.Rb(14,"mat-label"),h.yc(15,"Id del jugador"),h.Qb(),h.Mb(16,"input",11),h.Qb(),h.Rb(17,"button",12),h.Yb("click",function(){return h.oc(e),h.cc().jugarPartida(3)}),h.yc(18," Invitar \ud83c\udfae"),h.Qb(),h.Qb(),h.xc(19,q,2,2,"p",3),h.Rb(20,"button",5),h.Yb("click",function(){return h.oc(e),h.cc().aceptarPartida()}),h.yc(21,"Aceptar invitacion"),h.Qb(),h.Rb(22,"p"),h.yc(23,"Copia y envia el id a tu rival"),h.Qb(),h.Rb(24,"p"),h.yc(25),h.Rb(26,"button",13),h.Yb("click",function(){return h.oc(e),h.cc().copiarId()}),h.Rb(27,"mat-icon",14),h.yc(28,"content_copy"),h.Qb(),h.Qb(),h.Qb(),h.Qb()}if(2&e){const e=h.cc();h.Ab(3),h.ic("formControl",e.tiempo),h.Ab(1),h.ic("value",3),h.Ab(2),h.ic("value",5),h.Ab(2),h.ic("value",10),h.Ab(8),h.ic("formControl",e.contricanteId),h.Ab(1),h.ic("disabled",e.contricanteId.invalid),h.Ab(2),h.ic("ngIf",e.aceptarParitda),h.Ab(1),h.ic("disabled",!e.aceptarParitda),h.Ab(5),h.Ac("",e.getSocketId()," ")}}function F(e,t){if(1&e){const e=h.Sb();h.Rb(0,"button",15),h.Yb("click",function(){return h.oc(e),h.cc().salirEspera()}),h.yc(1," Cancelar "),h.Qb()}}let G=(()=>{class e{constructor(e,t,i,a,s){this.socketService=e,this.auth=t,this.dialogRef=i,this.data=a,this.componentes=s,this.suscripcion=new n.a,this.espera=!1,this.tiempo=new r.c(3),this.contricanteId=new r.c("",[r.o.required,r.o.minLength(4)]),this.aceptarRevancha=!1,this.pedirRevancha=!1,this.aceptarParitda=!1,null!=this.data&&(this.pedirRevancha=!0)}ngOnInit(){this.escuharPrivado()}ngOnDestroy(){this.suscripcion.unsubscribe()}getNombre(){return this.auth.usuario.username}getSocketId(){return this.socketService.socketId}copiarId(){navigator.clipboard.writeText(this.getSocketId()).then(()=>{}).catch(e=>{console.log("Error al copiar el id",e)})}getContricanteName(){return this.socketService.contricanteName}escuharPrivado(){const e=this.socketService.escucharEvento("privado").subscribe(e=>{switch(e.jugar){case J.JUGAR:this.socketService.contricanteName=this.auth.usuario.username===e.partida.blancas?e.partida.negras:e.partida.blancas,this.socketService.contricanteSocketId=this.auth.usuario.username===e.partida.blancas?e.partida.negrasSocketId:e.partida.blancasSocketId,this.dialogRef.close({partida:e.partida,tiempo:e.tiempo});break;case J.REVANCHA:void 0===e.aceptado&&(this.componentes.mostrarMensaje(`El jugador ${this.socketService.contricanteName}, quiere revancha`),this.aceptarRevancha=!0,this.partidaInvitacion={jugar:2,tiempo:e.tiempo,jugador:{username:this.getContricanteName(),usuarioUuid:"noNecesario"}});break;case J.PRIVADA:void 0===e.aceptado?(this.partidaInvitacion=e,this.componentes.mostrarMensaje(`El jugador ${e.jugador.username}, quiere jugar`),this.aceptarParitda=!0):e.aceptado||(this.componentes.mostrarMensaje("El jugador que invitaste no esta disponible"),this.espera=!1);break;case J.SALIR:this.pedirRevancha=!1,this.aceptarRevancha=!1,this.componentes.mostrarMensaje("El usuario se salio de tu sala"),this.partidaInvitacion=null}});this.suscripcion.add(e)}aceptarRevanchaButton(){this.socketService.emitirEvento("multijugador",{jugar:J.REVANCHA,aceptado:!0,tiempo:this.partidaInvitacion.tiempo})}aceptarPartida(){this.socketService.emitirEvento("multijugador",{jugar:J.PRIVADA,aceptado:!0,tiempo:this.partidaInvitacion.tiempo,jugador:this.partidaInvitacion.jugador,jugadorInvitado:{username:this.auth.usuario.username,usuarioUuid:this.auth.usuario.uuid},emisorId:this.partidaInvitacion.emisorId}),this.espera=!0}jugarPartida(e){const t={jugar:e,tiempo:this.tiempo.value};e!==J.JUGAR&&e!==J.PRIVADA||(t.jugador={username:this.auth.usuario.username,usuarioUuid:this.auth.usuario.uuid},e===J.PRIVADA&&(t.invitadoId=this.contricanteId.value)),this.socketService.emitirEvento("multijugador",t),this.espera=!0}prueba(){this.socketService.prueba()}salirEspera(){this.socketService.emitirEvento("multijugador",{jugar:0}),this.aceptarRevancha=!1,this.pedirRevancha=!1,this.espera=!1}mensaje(){this.socketService.emitirEvento("events",{mensaje:"Nmms wey"})}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(d.a),h.Lb(m.a),h.Lb(l.e),h.Lb(l.a),h.Lb(u.a))},e.\u0275cmp=h.Fb({type:e,selectors:[["app-multijugador"]],decls:4,vars:3,consts:[["style","text-align: center;",4,"ngIf"],[2,"text-align","center"],["class","btnAzul","mat-raised-button","",3,"click",4,"ngIf"],[4,"ngIf"],["class","btnAzul","style","margin-right: 10px;","mat-raised-button","",3,"disabled","click",4,"ngIf"],["mat-raised-button","",1,"btnAzul",3,"disabled","click"],["mat-raised-button","",1,"btnAzul",2,"margin-right","10px",3,"disabled","click"],["aria-label","Selecciona el tiempo",3,"formControl"],[2,"margin-left","2px","margin-right","2px",3,"value"],["mat-raised-button","",1,"btnAzul",2,"display","block","margin-left","auto","margin-right","auto","margin-top","5px",3,"click"],["appearance","fill",1,"example-full-width",2,"margin-right","5px"],["matInput","",3,"formControl"],["mat-raised-button","",1,"btnAzul",2,"vertical-align","text-bottom",3,"disabled","click"],["mat-mini-fab","",1,"btnAzul",3,"click"],[1,"mat-18"],["mat-raised-button","",1,"btnAzul",3,"click"]],template:function(e,t){1&e&&(h.xc(0,T,8,5,"div",0),h.xc(1,Q,29,9,"div",0),h.Rb(2,"div",1),h.xc(3,F,2,0,"button",2),h.Qb()),2&e&&(h.ic("ngIf",t.data&&!t.espera),h.Ab(1),h.ic("ngIf",!t.espera),h.Ab(2),h.ic("ngIf",t.espera))},directives:[a.l,p.a,z,r.k,r.d,w,S.b,S.e,X.a,r.b,N.a],styles:[".mat-dialog-container{padding:8px!important;background-color:#8ab9b5!important}[_nghost-%COMP%]     .mat-form-field-appearance-fill .mat-form-field-flex{background-color:#fffaf0;border-radius:18px}[_nghost-%COMP%]     .mat-form-field-appearance-fill .mat-form-field-underline{display:none}"]}),e})();var J=function(e){return e[e.SALIR=0]="SALIR",e[e.JUGAR=1]="JUGAR",e[e.REVANCHA=2]="REVANCHA",e[e.PRIVADA=3]="PRIVADA",e}({});function U(e,t){if(1&e){const e=h.Sb();h.Rb(0,"p",2),h.Yb("click",function(){h.oc(e);const i=t.$implicit;return h.cc().seleccionarPiza(i)}),h.yc(1),h.Qb()}if(2&e){const e=t.$implicit,i=h.cc();h.Ab(1),h.zc(i.piezaImagen(e))}}let $=(()=>{class e{constructor(e,t){this.blancas=e,this.matDialogRef=t,this.piezas=[c.a.CABALLO,c.a.ALFIL,c.a.TORRE,c.a.REINA]}ngOnInit(){}seleccionarPiza(e){this.matDialogRef.close(e)}piezaImagen(e){switch(e){case c.a.REY:return this.blancas?"\u2654":"\u265a";case c.a.REINA:return this.blancas?"\u2655":"\u265b";case c.a.TORRE:return this.blancas?"\u2656":"\u265c";case c.a.ALFIL:return this.blancas?"\u2657":"\u265d";case c.a.CABALLO:return this.blancas?"\u2658":"\u265e";case c.a.PEON:return this.blancas?"\u2659":"\u265f\ufe0e"}}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(l.a),h.Lb(l.e))},e.\u0275cmp=h.Fb({type:e,selectors:[["app-coronar"]],decls:3,vars:1,consts:[[2,"text-align","center","font-weight","bold"],["class","pieza",3,"click",4,"ngFor","ngForOf"],[1,"pieza",3,"click"]],template:function(e,t){1&e&&(h.Rb(0,"p",0),h.yc(1,"Selecciona la pieza"),h.Qb(),h.xc(2,U,2,1,"p",1)),2&e&&(h.Ab(2),h.ic("ngForOf",t.piezas))},directives:[a.k],styles:[".pieza[_ngcontent-%COMP%]{cursor:pointer;border:1px solid #555;margin:0 5px;font-size:36px;display:inline-block}.pieza[_ngcontent-%COMP%]:hover{background:rgba(118,177,255,.4745098039215686)}"]}),e})();var W=i("IheW"),Z=i("GU7r");const H=["input"],K=function(){return{enterDuration:150}},ee=["*"],te=new h.r("mat-checkbox-default-options",{providedIn:"root",factory:ie});function ie(){return{color:"accent",clickAction:"check-indeterminate"}}let ae=0;const se=ie(),ne={provide:r.i,useExisting:Object(h.U)(()=>le),multi:!0};class oe{}class ce{constructor(e){this._elementRef=e}}const re=Object(b.t)(Object(b.o)(Object(b.p)(Object(b.q)(ce))));let le=(()=>{class e extends re{constructor(e,t,i,a,s,n,o){super(e),this._changeDetectorRef=t,this._focusMonitor=i,this._ngZone=a,this._animationMode=n,this._options=o,this.ariaLabel="",this.ariaLabelledby=null,this._uniqueId="mat-checkbox-"+ ++ae,this.id=this._uniqueId,this.labelPosition="after",this.name=null,this.change=new h.o,this.indeterminateChange=new h.o,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=0,this._controlValueAccessorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||se,this.color=this.defaultColor=this._options.color||se.color,this.tabIndex=parseInt(s)||0}get inputId(){return(this.id||this._uniqueId)+"-input"}get required(){return this._required}set required(e){this._required=Object(g.c)(e)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e||Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}),this._syncIndeterminate(this._indeterminate)}ngAfterViewChecked(){}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}get checked(){return this._checked}set checked(e){e!=this.checked&&(this._checked=e,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){const t=Object(g.c)(e);t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(e){const t=e!=this._indeterminate;this._indeterminate=Object(g.c)(e),t&&(this._transitionCheckState(this._indeterminate?3:this.checked?1:2),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(e){this.checked=!!e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_getAriaChecked(){return this.checked?"true":this.indeterminate?"mixed":"false"}_transitionCheckState(e){let t=this._currentCheckState,i=this._elementRef.nativeElement;if(t!==e&&(this._currentAnimationClass.length>0&&i.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(t,e),this._currentCheckState=e,this._currentAnimationClass.length>0)){i.classList.add(this._currentAnimationClass);const e=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{i.classList.remove(e)},1e3)})}}_emitChangeEvent(){const e=new oe;e.source=this,e.checked=this.checked,this._controlValueAccessorChangeFn(this.checked),this.change.emit(e)}toggle(){this.checked=!this.checked}_onInputClick(e){var t;const i=null===(t=this._options)||void 0===t?void 0:t.clickAction;e.stopPropagation(),this.disabled||"noop"===i?this.disabled||"noop"!==i||(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==i&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this.toggle(),this._transitionCheckState(this._checked?1:2),this._emitChangeEvent())}focus(e,t){e?this._focusMonitor.focusVia(this._inputElement,e,t):this._inputElement.nativeElement.focus(t)}_onInteractionEvent(e){e.stopPropagation()}_getAnimationClassForCheckStateTransition(e,t){if("NoopAnimations"===this._animationMode)return"";let i="";switch(e){case 0:if(1===t)i="unchecked-checked";else{if(3!=t)return"";i="unchecked-indeterminate"}break;case 2:i=1===t?"unchecked-checked":"unchecked-indeterminate";break;case 1:i=2===t?"checked-unchecked":"checked-indeterminate";break;case 3:i=1===t?"indeterminate-checked":"indeterminate-unchecked"}return"mat-checkbox-anim-"+i}_syncIndeterminate(e){const t=this._inputElement;t&&(t.nativeElement.indeterminate=e)}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(h.l),h.Lb(h.h),h.Lb(f.e),h.Lb(h.A),h.Wb("tabindex"),h.Lb(k.a,8),h.Lb(te,8))},e.\u0275cmp=h.Fb({type:e,selectors:[["mat-checkbox"]],viewQuery:function(e,t){if(1&e&&(h.Dc(H,!0),h.Dc(b.j,!0)),2&e){let e;h.mc(e=h.Zb())&&(t._inputElement=e.first),h.mc(e=h.Zb())&&(t.ripple=e.first)}},hostAttrs:[1,"mat-checkbox"],hostVars:12,hostBindings:function(e,t){2&e&&(h.Ub("id",t.id),h.Bb("tabindex",null),h.Db("mat-checkbox-indeterminate",t.indeterminate)("mat-checkbox-checked",t.checked)("mat-checkbox-disabled",t.disabled)("mat-checkbox-label-before","before"==t.labelPosition)("_mat-animation-noopable","NoopAnimations"===t._animationMode))},inputs:{disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",labelPosition:"labelPosition",name:"name",required:"required",checked:"checked",disabled:"disabled",indeterminate:"indeterminate",ariaDescribedby:["aria-describedby","ariaDescribedby"],value:"value"},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],features:[h.zb([ne]),h.xb],ngContentSelectors:ee,decls:17,vars:20,consts:[[1,"mat-checkbox-layout"],["label",""],[1,"mat-checkbox-inner-container"],["type","checkbox",1,"mat-checkbox-input","cdk-visually-hidden",3,"id","required","checked","disabled","tabIndex","change","click"],["input",""],["matRipple","",1,"mat-checkbox-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleRadius","matRippleCentered","matRippleAnimation"],[1,"mat-ripple-element","mat-checkbox-persistent-ripple"],[1,"mat-checkbox-frame"],[1,"mat-checkbox-background"],["version","1.1","focusable","false","viewBox","0 0 24 24",0,"xml","space","preserve",1,"mat-checkbox-checkmark"],["fill","none","stroke","white","d","M4.1,12.7 9,17.6 20.3,6.3",1,"mat-checkbox-checkmark-path"],[1,"mat-checkbox-mixedmark"],[1,"mat-checkbox-label",3,"cdkObserveContent"],["checkboxLabel",""],[2,"display","none"]],template:function(e,t){if(1&e&&(h.hc(),h.Rb(0,"label",0,1),h.Rb(2,"span",2),h.Rb(3,"input",3,4),h.Yb("change",function(e){return t._onInteractionEvent(e)})("click",function(e){return t._onInputClick(e)}),h.Qb(),h.Rb(5,"span",5),h.Mb(6,"span",6),h.Qb(),h.Mb(7,"span",7),h.Rb(8,"span",8),h.bc(),h.Rb(9,"svg",9),h.Mb(10,"path",10),h.Qb(),h.ac(),h.Mb(11,"span",11),h.Qb(),h.Qb(),h.Rb(12,"span",12,13),h.Yb("cdkObserveContent",function(){return t._onLabelTextChange()}),h.Rb(14,"span",14),h.yc(15,"\xa0"),h.Qb(),h.gc(16),h.Qb(),h.Qb()),2&e){const e=h.nc(1),i=h.nc(13);h.Bb("for",t.inputId),h.Ab(2),h.Db("mat-checkbox-inner-container-no-side-margin",!i.textContent||!i.textContent.trim()),h.Ab(1),h.ic("id",t.inputId)("required",t.required)("checked",t.checked)("disabled",t.disabled)("tabIndex",t.tabIndex),h.Bb("value",t.value)("name",t.name)("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby)("aria-checked",t._getAriaChecked())("aria-describedby",t.ariaDescribedby),h.Ab(2),h.ic("matRippleTrigger",e)("matRippleDisabled",t._isRippleDisabled())("matRippleRadius",20)("matRippleCentered",!0)("matRippleAnimation",h.jc(19,K))}},directives:[b.j,Z.a],styles:["@keyframes mat-checkbox-fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes mat-checkbox-fade-out-background{0%,50%{opacity:1}100%{opacity:0}}@keyframes mat-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:22.910259}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1)}100%{stroke-dashoffset:0}}@keyframes mat-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mat-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);stroke-dashoffset:0}to{stroke-dashoffset:-22.910259}}@keyframes mat-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(45deg)}}@keyframes mat-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes mat-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0deg)}}@keyframes mat-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(315deg)}}@keyframes mat-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}32.8%,100%{opacity:0;transform:scaleX(0)}}.mat-checkbox-background,.mat-checkbox-frame{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:2px;box-sizing:border-box;pointer-events:none}.mat-checkbox{display:inline-block;transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);cursor:pointer;-webkit-tap-highlight-color:transparent}._mat-animation-noopable.mat-checkbox{transition:none;animation:none}.mat-checkbox .mat-ripple-element:not(.mat-checkbox-persistent-ripple){opacity:.16}.mat-checkbox-layout{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:inherit;align-items:baseline;vertical-align:middle;display:inline-flex;white-space:nowrap}.mat-checkbox-label{-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto}.mat-checkbox-inner-container{display:inline-block;height:16px;line-height:0;margin:auto;margin-right:8px;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}[dir=rtl] .mat-checkbox-inner-container{margin-left:8px;margin-right:auto}.mat-checkbox-inner-container-no-side-margin{margin-left:0;margin-right:0}.mat-checkbox-frame{background-color:transparent;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1);border-width:2px;border-style:solid}._mat-animation-noopable .mat-checkbox-frame{transition:none}.cdk-high-contrast-active .mat-checkbox.cdk-keyboard-focused .mat-checkbox-frame{border-style:dotted}.mat-checkbox-background{align-items:center;display:inline-flex;justify-content:center;transition:background-color 90ms cubic-bezier(0, 0, 0.2, 0.1),opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}._mat-animation-noopable .mat-checkbox-background{transition:none}.cdk-high-contrast-active .mat-checkbox .mat-checkbox-background{background:none}.mat-checkbox-persistent-ripple{display:block;width:100%;height:100%;transform:none}.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:.04}.mat-checkbox.cdk-keyboard-focused .mat-checkbox-persistent-ripple{opacity:.12}.mat-checkbox-persistent-ripple,.mat-checkbox.mat-checkbox-disabled .mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:0}@media(hover: none){.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{display:none}}.mat-checkbox-checkmark{top:0;left:0;right:0;bottom:0;position:absolute;width:100%}.mat-checkbox-checkmark-path{stroke-dashoffset:22.910259;stroke-dasharray:22.910259;stroke-width:2.1333333333px}.cdk-high-contrast-black-on-white .mat-checkbox-checkmark-path{stroke:#000 !important}.mat-checkbox-mixedmark{width:calc(100% - 6px);height:2px;opacity:0;transform:scaleX(0) rotate(0deg);border-radius:2px}.cdk-high-contrast-active .mat-checkbox-mixedmark{height:0;border-top:solid 2px;margin-top:2px}.mat-checkbox-label-before .mat-checkbox-inner-container{order:1;margin-left:8px;margin-right:auto}[dir=rtl] .mat-checkbox-label-before .mat-checkbox-inner-container{margin-left:auto;margin-right:8px}.mat-checkbox-checked .mat-checkbox-checkmark{opacity:1}.mat-checkbox-checked .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-checked .mat-checkbox-mixedmark{transform:scaleX(1) rotate(-45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark{opacity:0;transform:rotate(45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-indeterminate .mat-checkbox-mixedmark{opacity:1;transform:scaleX(1) rotate(0deg)}.mat-checkbox-unchecked .mat-checkbox-background{background-color:transparent}.mat-checkbox-disabled{cursor:default}.cdk-high-contrast-active .mat-checkbox-disabled{opacity:.5}.mat-checkbox-anim-unchecked-checked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-checked .mat-checkbox-checkmark-path{animation:180ms linear 0ms mat-checkbox-unchecked-checked-checkmark-path}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-unchecked-indeterminate-mixedmark}.mat-checkbox-anim-checked-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-checked-unchecked .mat-checkbox-checkmark-path{animation:90ms linear 0ms mat-checkbox-checked-unchecked-checkmark-path}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-checkmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-checkmark}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-mixedmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-checkmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-checkmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-mixedmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-mixedmark}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-mixedmark{animation:300ms linear 0ms mat-checkbox-indeterminate-unchecked-mixedmark}.mat-checkbox-input{bottom:0;left:50%}.mat-checkbox .mat-checkbox-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}\n"],encapsulation:2,changeDetection:0}),e})(),he=(()=>{class e{}return e.\u0275mod=h.Jb({type:e}),e.\u0275inj=h.Ib({factory:function(t){return new(t||e)}}),e})(),de=(()=>{class e{}return e.\u0275mod=h.Jb({type:e}),e.\u0275inj=h.Ib({factory:function(t){return new(t||e)},imports:[[b.k,b.g,Z.c,he],b.g,he]}),e})();var me=i("AytR");function ue(e,t){if(1&e&&(h.Rb(0,"div",7),h.Rb(1,"mat-form-field",8),h.Rb(2,"mat-label"),h.yc(3,"Justifica tu respuesta "),h.Qb(),h.Mb(4,"textarea",9),h.Qb(),h.Rb(5,"p"),h.yc(6),h.Qb(),h.Qb()),2&e){const e=h.cc();h.Ab(4),h.ic("formControl",e.comentario),h.Ab(2),h.Ac("Letras restantes : ",e.comentario.value.length<=100?100-e.comentario.value.length:"LIMTE","")}}const pe=function(e){return{seleccionada:e}};let be=(()=>{class e{constructor(e,t,i){this.http=e,this.partidaId=t,this.dialogRef=i,this.comentario=new r.c("",[r.o.maxLength(100)]),this.calificacion=0}ngOnInit(){}seleccionarCara(e){this.calificacion=e}comentarPartida(){const e={calificacion:this.calificacion,comentario:this.comentario.value.trim().length>0?this.comentario.value.trim():null,partidaId:this.partidaId,error:this.checkbox.checked},t=(new W.c).append("Authorization","Bearer "+localStorage.getItem("token"));this.http.post(me.a+"/comentarios",e,{headers:t}).subscribe(e=>{},e=>{console.log("Error al grabar comentario ",e)}),this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(W.a),h.Lb(l.a),h.Lb(l.e))},e.\u0275cmp=h.Fb({type:e,selectors:[["app-comentario"]],viewQuery:function(e,t){if(1&e&&h.tc(le,!0),2&e){let e;h.mc(e=h.Zb())&&(t.checkbox=e.first)}},decls:25,vars:12,consts:[[2,"text-align","center"],["mat-stroked-button","","color","primary",1,"separacionIconos",3,"ngClass","click"],[2,"text-align","center","margin-bottom","5px"],["color","primary",2,"margin-left","auto","margin-right","auto",3,"checked"],["ErrorInput",""],["style","text-align: center;margin-top: 5px;",4,"ngIf"],["mat-raised-button","",1,"btnAzul",3,"disabled","click"],[2,"text-align","center","margin-top","5px"],["appearance","fill"],["matInput","",2,"height","110px","resize","none",3,"formControl"]],template:function(e,t){1&e&&(h.Rb(0,"p",0),h.yc(1," Califica la dificultad de tu oponente "),h.Qb(),h.Rb(2,"div",0),h.Rb(3,"button",1),h.Yb("click",function(){return t.seleccionarCara(0)}),h.yc(4," FACIL "),h.Rb(5,"mat-icon"),h.yc(6,"sentiment_very_satisfied"),h.Qb(),h.Qb(),h.Rb(7,"button",1),h.Yb("click",function(){return t.seleccionarCara(1)}),h.yc(8," MEDIA "),h.Rb(9,"mat-icon"),h.yc(10,"sentiment_neutral"),h.Qb(),h.Qb(),h.Rb(11,"button",1),h.Yb("click",function(){return t.seleccionarCara(2)}),h.yc(12," DIFICIL "),h.Rb(13,"mat-icon"),h.yc(14,"sentiment_very_dissatisfied"),h.Qb(),h.Qb(),h.Qb(),h.Rb(15,"p",0),h.yc(16,"Si identificaste un error apoya marcandolo y explicandolo \ud83d\ude0e "),h.Qb(),h.Rb(17,"div",2),h.Rb(18,"mat-checkbox",3,4),h.yc(20,"ERROR"),h.Qb(),h.Qb(),h.xc(21,ue,7,2,"div",5),h.Rb(22,"div",0),h.Rb(23,"button",6),h.Yb("click",function(){return t.comentarPartida()}),h.yc(24,"GUARDAR"),h.Qb(),h.Qb()),2&e&&(h.Ab(3),h.ic("ngClass",h.kc(6,pe,0===t.calificacion)),h.Ab(4),h.ic("ngClass",h.kc(8,pe,1===t.calificacion)),h.Ab(4),h.ic("ngClass",h.kc(10,pe,2===t.calificacion)),h.Ab(7),h.ic("checked",!1),h.Ab(3),h.ic("ngIf",t.checkbox.checked),h.Ab(2),h.ic("disabled",t.comentario.invalid))},directives:[p.a,a.j,N.a,le,a.l,S.b,S.e,X.a,r.b,r.k,r.d],styles:[".separacionIconos[_ngcontent-%COMP%]{margin-left:5px;margin-right:5px;margin-top:5px}.seleccionada[_ngcontent-%COMP%]{animation:randomColors 1s infinite;border-width:5px}@keyframes randomColors{0%{border-color:red}25%{border-color:#00f}50%{border-color:green}75%{border-color:#ff0}to{border-color:purple}}"]}),e})();var ge=i("tyNb");const ke=function(e){return{piezaPropia:e}};function fe(e,t){if(1&e&&(h.Rb(0,"p",10),h.yc(1),h.Qb()),2&e){const e=h.cc().$implicit,t=h.cc().$implicit,i=h.cc();h.ic("ngClass",h.kc(2,ke,i.piezaPropia(i.casillas[i.getIndexByXY(e,t)]))),h.Ab(1),h.Ac(" ",i.getUnicode(i.casillas[i.getIndexByXY(e,t)])," ")}}const xe=function(e){return{movimientos:e}};function Ie(e,t){if(1&e){const e=h.Sb();h.Rb(0,"td",8),h.Yb("click",function(){h.oc(e);const i=t.$implicit,a=h.cc().$implicit;return h.cc().seleccionarCasilla(i,a)}),h.xc(1,fe,2,4,"p",9),h.Qb()}if(2&e){const e=t.$implicit,i=h.cc().$implicit,a=h.cc();h.ic("id",e+""+i)("ngClass",h.kc(3,xe,a.casillasPosibles[a.getIndexByXY(e,i)])),h.Ab(1),h.ic("ngIf",null!=a.casillas[a.getIndexByXY(e,i)])}}function ye(e,t){if(1&e&&(h.Rb(0,"tr"),h.xc(1,Ie,2,5,"td",7),h.Qb()),2&e){const e=h.cc();h.Ab(1),h.ic("ngForOf",e.orientacionColumns)}}function ve(e,t){if(1&e){const e=h.Sb();h.Rb(0,"button",3),h.Yb("click",function(){return h.oc(e),h.cc().pedirTablas()}),h.yc(1," Pedir tablas "),h.Rb(2,"mat-icon",4),h.yc(3,"flag"),h.Qb(),h.Qb()}if(2&e){const e=h.cc();h.ic("disabled",!e.miTurno)}}function Re(e,t){if(1&e){const e=h.Sb();h.Rb(0,"button",11),h.Yb("click",function(){return h.oc(e),h.cc().aceptarTablas()}),h.yc(1," Aceptar tablas "),h.Rb(2,"mat-icon",4),h.yc(3,"flag"),h.Qb(),h.Qb()}}let _e=(()=>{class e{constructor(e,t,i,a){this.socketService=e,this.router=t,this.matDialog=i,this.auth=a,this.soyBlancas=!1,this.suscripciones=new n.a,this.casillas=new Array(64).fill(null,0,64),this.casillasPosibles=new Array(64).fill(!1,0,64),this.orientacionRows=[7,6,5,4,3,2,1,0],this.orientacionColumns=[0,1,2,3,4,5,6,7],this.indexMap=new Map,this.coordsMap=new Map,this.nombresCasillas=["a1","b1","c1","d1","e1","f1","g1","h1","a2","b2","c2","d2","e2","f2","g2","h2","a3","b3","c3","d3","e3","f3","g3","h3","a4","b4","c4","d4","e4","f4","g4","h4","a5","b5","c5","d5","e5","f5","g5","h5","a6","b6","c6","d6","e6","f6","g6","h6","a7","b7","c7","d7","e7","f7","g7","h7","a8","b8","c8","d8","e8","f8","g8","h8"],this.piezaSeleccionada=null,this.movimientosPosibles=[],this.enroqueCorto=!0,this.enroqueLargo=!0,this.piezasEnemigoCantidad=16,this.partidaTiempo=0,this.miTiempoRestante=0,this.tiempoRestanteContricante=0,this.tablasStatus=null,this.jugando=!1,this.capturaSonido=new Audio("assets/captura.mp3"),this.movSonido=new Audio("assets/movimiento.mp3");let s=0;for(let n=0;n<8;n++)for(let e=0;e<8;e++)this.indexMap.set(`${e}${n}`,s),this.coordsMap.set(s,{x:e,y:n}),s++;this.jugarMultijugador(),this.socketService.getIdClient()||this.socketService.conectarSocket(),this.escucharEventos()}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){this.suscripciones.unsubscribe()}getContricanteName(){return this.socketService.contricanteName}pedirTablas(){this.tablasStatus=!1,this.socketService.emitirEvento("pedir-tablas",{})}getName(){return this.auth.usuario.username}jugarMultijugador(e){this.matDialog.open(G,{disableClose:!0,hasBackdrop:!0,id:"multijugador",data:e,width:window.innerWidth>=500?"400px":"auto"}).afterClosed().subscribe(e=>Object(s.a)(this,void 0,void 0,function*(){void 0!==e&&(this.partidaId=e.partida.id,this.inicializarPiezas(),this.tablasStatus=null,this.soyBlancas=e.partida.blancas===this.auth.usuario.username,this.partidaTiempo=60*e.tiempo,this.tiempoRestanteContricante=this.partidaTiempo,this.miTiempoRestante=this.partidaTiempo,this.soyBlancas?(this.orientacionRows=[7,6,5,4,3,2,1,0],this.orientacionColumns=[0,1,2,3,4,5,6,7]):(this.orientacionRows=[0,1,2,3,4,5,6,7],this.orientacionColumns=[7,6,5,4,3,2,1,0]),this.usernameEnemigo=this.soyBlancas?e.partida.negras:e.partida.blancas,this.miTurno=this.soyBlancas,this.inicioMovimiento=Date.now(),this.temporizador=setInterval(()=>{0===this.miTiempoRestante?(clearInterval(this.temporizador),this.emitirVentoARoom({tipo:o.a.TIEMPO}),this.jugarMultijugador({resultado:"Tiempo terminado",ganador:this.socketService.contricanteName})):(this.miTiempoRestante>0||this.tiempoRestanteContricante>0)&&(this.miTurno?this.miTiempoRestante--:this.tiempoRestanteContricante--)},1e3))})),e&&this.matDialog.open(be,{data:this.partidaId,disableClose:!0,width:window.innerWidth>=500?"400px":"auto"})}reproducirSonido(e){return Object(s.a)(this,void 0,void 0,function*(){switch(e){case 1:yield this.movSonido.play();break;case 2:yield this.capturaSonido.play()}})}timepoRestante(e){const t=e%60;return`${Math.floor(e/60)}:${t<10?"0"+t:t}`}aceptarTablas(){this.socketService.emitirEvento("pedir-tablas",{aceptado:!0}),clearInterval(this.temporizador),this.jugarMultijugador({resultado:"Tablas \ud83e\udd1d"})}rendirme(){this.miTurno=!1,this.emitirVentoARoom({tipo:o.a.RENDICION}),this.jugarMultijugador({resultado:"RENDICION \ud83d\ude23",ganador:this.socketService.contricanteName}),clearInterval(this.temporizador)}emitirVentoARoom(e){this.socketService.emitirEventoRoom(e)}prueba(){this.socketService.prueba()}escucharEventos(){const e=this.socketService.escucharEvento("evento-room").subscribe(e=>{this.aplicarEvento(e)},e=>{console.log("Error en listener ",e)});this.suscripciones.add(e);const t=this.socketService.escucharEvento("status-partida").subscribe(e=>{switch(clearInterval(this.temporizador),this.miTurno=!1,e.statusPartida){case o.a.JAQUE_MATE:this.jugarMultijugador({resultado:"Jaque-mate \ud83d\ude0e",ganador:this.socketService.contricanteName});break;case o.a.TABLAS:this.jugarMultijugador({resultado:"Tablas \ud83e\udd1d"});break;case o.a.DESCONECCION:this.matDialog.getDialogById("multijugador")||this.jugarMultijugador({resultado:"El jugador se desconecto \u2757\ufe0f"});break;case o.a.RENDICION:this.jugarMultijugador({resultado:"El jugador se rindio \ud83c\udff3",ganador:this.getName()});break;case o.a.TIEMPO:this.jugarMultijugador({resultado:"Se le termino el tiempo al jugador \u231b\ufe0f",ganador:this.getName()})}},e=>{console.log("Error en el status partida ",e)});this.suscripciones.add(t);const i=this.socketService.escucharEvento("pedir-tablas").subscribe(()=>{this.tablasStatus=!0},e=>{console.log("Error al pedir tablas",e)});this.suscripciones.add(i)}aplicarEvento(e){var t;switch(void 0===e.tipoJaquemate?e.tipo:e.tipoJaquemate){case o.a.JAQUE:case o.a.TABLAS:case o.a.MOVIMENTO:null!=(null===(t=e.movimiento)||void 0===t?void 0:t.peonAlPasoCasilla)&&(this.peonPasoCasilla=e.movimiento.peonAlPasoCasilla),this.moverPieza(this.piezasPartidaEstado.get(e.movimiento.piezaId).casillaIndex,e.movimiento.casillaDestino);break;case o.a.CORONADO:const i=this.piezasPartidaEstado.get(e.movimiento.piezaId);this.moverPieza(i.casillaIndex,e.movimiento.casillaDestino),i.tipo=e.coronadoPieza,i.unicode=this.piezaImagen(e.coronadoPieza,!this.soyBlancas),this.reproducirSonido(1);break;case o.a.ENROQUE_CORTO:this.moverPieza(this.soyBlancas?60:4,this.soyBlancas?62:6),this.moverPieza(this.soyBlancas?63:7,this.soyBlancas?61:5),this.reproducirSonido(1);break;case o.a.ENROQUE_LARGO:this.moverPieza(this.soyBlancas?60:4,this.soyBlancas?58:2),this.moverPieza(this.soyBlancas?56:0,this.soyBlancas?59:3),this.reproducirSonido(1);break;case o.a.PEON_AL_PASO:this.moverPieza(this.piezasPartidaEstado.get(e.movimiento.piezaId).casillaIndex,e.movimiento.casillaDestino),this.casillas[this.piezasPartidaEstado.get(e.movimiento.comidaId).casillaIndex]=null,this.piezasPartidaEstado.delete(e.movimiento.comidaId),this.reproducirSonido(2)}this.miTurno=!0,this.inicioMovimiento=Date.now()}piezaSeleccionadaColor(e){return e==this.piezaSeleccionada?(console.log("Cierto"),!0):(console.log("Falso"),!1)}seleccionarCasilla(e,t){const i=this.getIndexByXY(e,t);this.miTurno&&(null!=this.piezaSeleccionada&&this.piezaSeleccionada===i||(!this.casillaVacia(i,this.casillas)&&this.piezaPropia(this.casillas[i])&&(this.piezaSeleccionada=i,this.movimientosPosibles.forEach(e=>this.casillasPosibles[e]=!1),this.movimientosPosibles=this.movimientosSinJaque(this.casillas[i]).filter(e=>e!=this.piezasPartidaEstado.get(this.soyBlancas?29:5).casillaIndex),this.movimientosPosibles.forEach(e=>this.casillasPosibles[e]=!0)),this.movimientosPosibles.includes(i)&&(this.tiempoDemora=Date.now()-this.inicioMovimiento,this.movimiento(this.piezaSeleccionada,i),this.piezaSeleccionada=null,this.movimientosPosibles.forEach(e=>this.casillasPosibles[e]=!1),this.movimientosPosibles=[],this.miTurno=!1)))}movimientosCasilla(e){return this.movimientosPosibles.includes(e)}piezaPropia(e){return this.soyBlancas&&e<=16||!this.soyBlancas&&e>=17}getXYByIndex(e){return this.coordsMap.get(e)}getIndexByXY(e,t){return this.indexMap.get(`${e}${t}`)}casillaVacia(e,t){return null==t[e]}casillaDisponible(e,t,i,a){return this.isValidCoord(e,t)&&(this.casillaVacia(this.getIndexByXY(e,t),a)||!this.casillaVacia(this.getIndexByXY(e,t),a)&&(i?a[this.getIndexByXY(e,t)]>=17:a[this.getIndexByXY(e,t)]<=16))}movimiento(e,t){const i=this.piezasPartidaEstado.get(this.casillas[e]).tipo;if(i===c.a.REY)return this.reyMovimiento(e,t);if(i===c.a.PEON)return this.peonMovimiento(e,t);const a=this.casillaVacia(t,this.casillas)?{tipo:o.a.MOVIMENTO,movimiento:{piezaId:this.casillas[e],casillaDestino:t,tiempoDemora:this.tiempoDemora,notacionAlg:this.getNotacionAlg(e,t),tiempoRestante:this.miTiempoRestante}}:{tipo:o.a.MOVIMENTO,movimiento:{piezaId:this.casillas[e],casillaDestino:t,comidaId:this.casillas[t],tiempoDemora:this.tiempoDemora,notacionAlg:this.getNotacionAlg(e,t),tiempoRestante:this.miTiempoRestante}};this.moverPieza(e,t),this.validarJaquemate(a)}validarJaquemate(e){const t=this.soyBlancas?29:5,i=this.piezasPartidaEstado.get(t);if(this.movimientosValidos(this.casillas[e.movimiento.casillaDestino],this.soyBlancas,this.casillas,this.piezasPartidaEstado).includes(i.casillaIndex))this.solucionesReyEnemigo(t,this.casillas[e.movimiento.casillaDestino],e);else{const a=this.soyBlancas?16:32;let s=0;for(let e=this.soyBlancas?1:17;e<=a;e++)if(this.piezasPartidaEstado.has(e)&&this.movimientosValidos(e,this.soyBlancas,this.casillas,this.piezasPartidaEstado).includes(i.casillaIndex)){s=e;break}if(0===s)return void this.emitirVentoARoom(e);this.solucionesReyEnemigo(t,s,e)}}solucionesReyEnemigo(e,t,i){if(0===this.movimientosSinJaque(e).length){if(1===this.piezasEnemigoCantidad)return i.tipo=o.a.TABLAS,void this.emitirVentoARoom(i);let t=!1;const a=this.soyBlancas?32:16;for(let i=this.soyBlancas?17:1;i<=a;i++)if(e!==i&&this.piezasPartidaEstado.has(i)&&this.movimientosSinJaque(i).length>0){t=!0;break}t?(i.tipoJaquemate=i.tipo,i.tipo=o.a.JAQUE,i.movimiento.notacionAlg+="+",this.emitirVentoARoom(i)):(i.tipoJaquemate=i.tipo,i.tipo=o.a.JAQUE_MATE,i.movimiento.notacionAlg+="#",this.emitirVentoARoom(i),this.jugarMultijugador({resultado:"Jaque-mate",ganador:this.getName()}))}else i.tipoJaquemate=i.tipo,i.tipo=o.a.JAQUE,i.movimiento.notacionAlg+="+",this.emitirVentoARoom(i)}moverPieza(e,t){this.casillaVacia(t,this.casillas)?(this.casillas[t]=this.casillas[e],this.piezasPartidaEstado.get(this.casillas[e]).casillaIndex=t,this.casillas[e]=null,this.reproducirSonido(1)):(this.piezasPartidaEstado.delete(this.casillas[t]),this.piezaPropia(this.casillas[t])||this.piezasEnemigoCantidad--,this.reproducirSonido(2),this.casillas[t]=this.casillas[e],this.piezasPartidaEstado.get(this.casillas[e]).casillaIndex=t,this.casillas[e]=null)}getNotacionAlg(e,t){let i="";const a=this.piezasPartidaEstado.get(this.casillas[e]).tipo;let s=!1;for(let n=this.soyBlancas?1:17;this.soyBlancas?n<=16:n<=32;n++){if(void 0===this.piezasPartidaEstado.get(n)||n===this.casillas[e])continue;const i=this.movimientosValidos(n,this.soyBlancas,this.casillas,this.piezasPartidaEstado);if(this.piezasPartidaEstado.get(n).tipo===a&&i.includes(t)){s=!0;break}}switch(a){case c.a.ALFIL:i+="B";break;case c.a.CABALLO:i+="N";break;case c.a.REINA:i+="Q";break;case c.a.REY:i+="K";break;case c.a.TORRE:i+="R"}return s&&(i+=this.nombresCasillas[e].charAt(0)),s||a!==c.a.PEON||this.casillaVacia(t,this.casillas)||(i+=this.nombresCasillas[e].charAt(0)),this.casillaVacia(t,this.casillas)||(i+="x"),i+=this.nombresCasillas[t],i}peonMovimiento(e,t){if(this.soyBlancas?e+16===t:e-16===t){const i={tipo:o.a.MOVIMENTO,movimiento:{piezaId:this.casillas[e],casillaDestino:t,peonAlPasoCasilla:t,tiempoDemora:this.tiempoDemora,notacionAlg:this.getNotacionAlg(e,t),tiempoRestante:this.miTiempoRestante}};return this.moverPieza(e,t),void this.validarJaquemate(i)}if(this.peonPasoCasilla){const{x:i,y:a}=this.getXYByIndex(this.peonPasoCasilla);if(this.soyBlancas?this.getIndexByXY(i,a+1)===t:this.getIndexByXY(i,a-1)===t){const i={tipo:o.a.PEON_AL_PASO,movimiento:{piezaId:this.casillas[e],casillaDestino:t,comidaId:this.casillas[this.peonPasoCasilla],tiempoDemora:this.tiempoDemora,notacionAlg:this.nombresCasillas[e].charAt(0)+"x"+this.nombresCasillas[t],tiempoRestante:this.miTiempoRestante}};return this.piezasPartidaEstado.delete(this.casillas[this.peonPasoCasilla]),this.casillas[this.peonPasoCasilla]=null,this.moverPieza(e,t),void this.validarJaquemate(i)}this.peonPasoCasilla=null}const i=this.soyBlancas?7:0,{y:a}=this.getXYByIndex(t);if(i===a){const i=this.getNotacionAlg(e,t);return this.moverPieza(e,t),void this.coronarPeon(t,i)}const s=this.casillaVacia(e,this.casillas)?{tipo:o.a.MOVIMENTO,movimiento:{piezaId:this.casillas[e],casillaDestino:t,tiempoDemora:this.tiempoDemora,notacionAlg:this.getNotacionAlg(e,t),tiempoRestante:this.miTiempoRestante}}:{tipo:o.a.MOVIMENTO,movimiento:{piezaId:this.casillas[e],casillaDestino:t,comidaId:this.casillas[t],tiempoDemora:this.tiempoDemora,notacionAlg:this.getNotacionAlg(e,t),tiempoRestante:this.miTiempoRestante}};this.moverPieza(e,t),this.validarJaquemate(s)}reyMovimiento(e,t){if(this.enroqueCorto){const i=this.soyBlancas?8:32;if(this.casillas[e]===i&&(this.enroqueCorto=!1),t===e+2){this.enroqueLargo=!1,this.enroqueCorto=!1;const a=this.piezasPartidaEstado.get(i);this.casillas[t-1]=i,this.casillas[a.casillaIndex]=null,a.casillaIndex=t-1,this.moverPieza(e,t);const s=this.soyBlancas?5:29;return this.validarJaquemate({tipo:o.a.ENROQUE_CORTO,movimiento:{piezaId:this.casillas[t],casillaDestino:t,notacionAlg:"0-0",tiempoDemora:this.tiempoDemora,tiempoRestante:this.miTiempoRestante},reyId:s}),void((this.enroqueCorto||this.enroqueLargo)&&this.casillas[e]===s&&(this.enroqueLargo=!1,this.enroqueCorto=!1))}}if(this.enroqueLargo){const i=this.soyBlancas?1:25;if(this.casillas[e]===i&&(this.enroqueLargo=!1),t===e-2){this.enroqueLargo=!1,this.enroqueCorto=!1;const a=this.piezasPartidaEstado.get(i);this.casillas[t+1]=i,this.casillas[a.casillaIndex]=null,a.casillaIndex=t+1,this.moverPieza(e,t);const s=this.soyBlancas?5:29;return this.validarJaquemate({tipo:o.a.ENROQUE_LARGO,movimiento:{casillaDestino:t,piezaId:this.casillas[t],notacionAlg:"0-0-0",tiempoDemora:this.tiempoDemora,tiempoRestante:this.miTiempoRestante},reyId:s}),void((this.enroqueCorto||this.enroqueLargo)&&this.casillas[e]===s&&(this.enroqueLargo=!1,this.enroqueCorto=!1))}}const i=this.soyBlancas?5:29;(this.enroqueCorto||this.enroqueLargo)&&this.casillas[e]===i&&(this.enroqueLargo=!1,this.enroqueCorto=!1);const a=this.getNotacionAlg(e,t);this.moverPieza(e,t),this.validarJaquemate({tipo:o.a.MOVIMENTO,movimiento:{piezaId:i,casillaDestino:t,tiempoDemora:this.tiempoDemora,notacionAlg:a,tiempoRestante:this.miTiempoRestante}})}movimientosPiezaSeleccionada(e,t,i,a){switch(a.get(e).tipo){case c.a.REY:return this.movimientosReySeleccionado(a.get(e).casillaIndex,t,i,a);case c.a.TORRE:return this.movimientosEnCruz(e,t,i,a);case c.a.PEON:return this.movimientosPeonSeleccionado(e,t,i,a);case c.a.CABALLO:return this.movimientosCaballo(a.get(e).casillaIndex,t,i);case c.a.ALFIL:return this.movimientosEnX(a.get(e).casillaIndex,t,i);case c.a.REINA:return[...this.movimientosEnCruz(e,t,i,a),...this.movimientosEnX(a.get(e).casillaIndex,t,i)]}}movimientosValidos(e,t,i,a){switch(a.get(e).tipo){case c.a.REY:return this.movimientosRey(a.get(e).casillaIndex,t,i,a);case c.a.TORRE:return this.movimientosEnCruz(e,t,i,a);case c.a.PEON:return this.movimientosPeon(e,t,i,a);case c.a.CABALLO:return this.movimientosCaballo(a.get(e).casillaIndex,t,i);case c.a.ALFIL:return this.movimientosEnX(a.get(e).casillaIndex,t,i);case c.a.REINA:return[...this.movimientosEnCruz(e,t,i,a),...this.movimientosEnX(a.get(e).casillaIndex,t,i)]}}movimientosSinJaque(e){const t=e<17,i=this.movimientosPiezaSeleccionada(e,t,this.casillas,this.piezasPartidaEstado),a=[...this.casillas],s=structuredClone(this.piezasPartidaEstado),n=s.get(e).casillaIndex,o=s.get(e),c=t?5:29;return i.filter(i=>{let r,l;null!=a[i]&&(l=a[i],r=s.get(l),s.delete(l)),a[i]=a[o.casillaIndex],a[o.casillaIndex]=null,s.get(e).casillaIndex=i;const h=this.cargarAreaJugador(!t,a,s).includes(s.get(c).casillaIndex);return r?(a[r.casillaIndex]=l,s.set(l,r)):a[i]=null,a[n]=e,s.get(e).casillaIndex=n,!h})}movimientosReySeleccionado(e,t,i,a){const s=[];s.push(...this.movimientosRey(e,t,i,a));const n=this.cargarAreaJugador(!t,i,a),o=n.includes(e);return this.enroqueCorto&&!o&&this.casillaVacia(e+1,i)&&this.casillaVacia(e+2,i)&&!n.includes(e+1)&&!n.includes(e+2)&&s.push(e+2),this.enroqueLargo&&!o&&this.casillaVacia(e-1,i)&&this.casillaVacia(e-2,i)&&this.casillaVacia(e-3,i)&&!n.includes(e-1)&&!n.includes(e-2)&&!n.includes(e-3)&&s.push(e-2),s}movimientosRey(e,t,i,a){const{x:s,y:n}=this.getXYByIndex(e);let o=[];const c=this.buscarReyEnemigo(e,i,a);return this.areaRey(s,n).forEach(e=>{const a=this.getXYByIndex(e);this.casillaDisponible(a.x,a.y,t,i)&&o.push(e)}),o=o.filter(e=>!c.includes(e)),o}buscarReyEnemigo(e,t,i){const{x:a,y:s}=this.getXYByIndex(e);let n=a-2;n<0&&(n=0);let o=a+2;if(o>7&&(o=7),s+2<=7)for(let h=n;h<=o;h++){const e=this.getIndexByXY(h,s+2);if(!this.casillaVacia(e,t)&&i.get(t[e]).tipo===c.a.REY)return this.areaRey(h,s+2)}if(s-2>=0)for(let h=n;h<=o;h++){const e=this.getIndexByXY(h,s-2);if(!this.casillaVacia(e,t)&&i.get(t[e]).tipo===c.a.REY)return this.areaRey(h,s-2)}let r=s+1;r>7&&(r=7);let l=s-1;if(l<0&&(l=0),a>1)for(let h=r;h>=l;h--){const e=this.getIndexByXY(a-2,h);if(!this.casillaVacia(e,t)&&i.get(t[e]).tipo===c.a.REY)return this.areaRey(a-2,h)}if(a<6)for(let h=r;h>=l;h--){const e=this.getIndexByXY(a+2,h);if(!this.casillaVacia(e,t)&&i.get(t[e]).tipo===c.a.REY)return this.areaRey(a+2,h)}return[]}areaRey(e,t){let i=t+1;i>7&&(i=i=7);let a=t-1;a<0&&(a=0);let s=e-1;s<0&&(s=e);let n=e+1;n>7&&(n=e);const o=[];for(let c=i;c>=a;c--)for(let e=s;e<=n;e++)o.push(this.getIndexByXY(e,c));return o.filter(i=>i!=this.getIndexByXY(e,t))}movimientosEnX(e,t,i){const{x:a,y:s}=this.getXYByIndex(e),n=[];let o=a+1,c=s+1;for(;this.isValidCoord(o,c);){if(!this.casillaVacia(this.getIndexByXY(o,c),i)&&(t?i[this.getIndexByXY(o,c)]>=17:i[this.getIndexByXY(o,c)]<=16)){n.push(this.getIndexByXY(o,c));break}if(!this.casillaVacia(this.getIndexByXY(o,c),i))break;n.push(this.getIndexByXY(o,c)),o++,c++}for(o=a-1,c=s+1;this.isValidCoord(o,c);){if(!this.casillaVacia(this.getIndexByXY(o,c),i)&&(t?i[this.getIndexByXY(o,c)]>=17:i[this.getIndexByXY(o,c)]<=16)){n.push(this.getIndexByXY(o,c));break}if(!this.casillaVacia(this.getIndexByXY(o,c),i))break;n.push(this.getIndexByXY(o,c)),o--,c++}for(o=a-1,c=s-1;this.isValidCoord(o,c);){if(!this.casillaVacia(this.getIndexByXY(o,c),i)&&(t?i[this.getIndexByXY(o,c)]>=17:i[this.getIndexByXY(o,c)]<=16)){n.push(this.getIndexByXY(o,c));break}if(!this.casillaVacia(this.getIndexByXY(o,c),i))break;n.push(this.getIndexByXY(o,c)),o--,c--}for(o=a+1,c=s-1;this.isValidCoord(o,c);){if(!this.casillaVacia(this.getIndexByXY(o,c),i)&&(t?i[this.getIndexByXY(o,c)]>=17:i[this.getIndexByXY(o,c)]<=16)){n.push(this.getIndexByXY(o,c));break}if(!this.casillaVacia(this.getIndexByXY(o,c),i))break;n.push(this.getIndexByXY(o,c)),o++,c--}return n}movimientosEnCruz(e,t,i,a){const{x:s,y:n}=this.getXYByIndex(a.get(e).casillaIndex),o=[];if(s<7)for(let c=s+1;c<8;c++){if(!this.casillaVacia(this.getIndexByXY(c,n),i)&&(t?i[this.getIndexByXY(c,n)]>=17:i[this.getIndexByXY(c,n)]<=16)){o.push(this.getIndexByXY(c,n));break}if(!this.casillaVacia(this.getIndexByXY(c,n),i))break;o.push(this.getIndexByXY(c,n))}if(s>0)for(let c=s-1;c>=0;c--){if(!this.casillaVacia(this.getIndexByXY(c,n),i)&&(t?i[this.getIndexByXY(c,n)]>=17:i[this.getIndexByXY(c,n)]<=16)){o.push(this.getIndexByXY(c,n));break}if(!this.casillaVacia(this.getIndexByXY(c,n),i))break;o.push(this.getIndexByXY(c,n))}if(n<7)for(let c=n+1;c<8;c++){if(!this.casillaVacia(this.getIndexByXY(s,c),i)&&(t?i[this.getIndexByXY(s,c)]>=17:i[this.getIndexByXY(s,c)]<=16)){o.push(this.getIndexByXY(s,c));break}if(!this.casillaVacia(this.getIndexByXY(s,c),i))break;o.push(this.getIndexByXY(s,c))}if(n>0)for(let c=n-1;c>=0;c--){if(!this.casillaVacia(this.getIndexByXY(s,c),i)&&(t?i[this.getIndexByXY(s,c)]>=17:i[this.getIndexByXY(s,c)]<=16)){o.push(this.getIndexByXY(s,c));break}if(!this.casillaVacia(this.getIndexByXY(s,c),i))break;o.push(this.getIndexByXY(s,c))}return o}movimientosCaballo(e,t,i){const{x:a,y:s}=this.getXYByIndex(e),n=[];return this.casillaDisponible(a+1,s+2,t,i)&&n.push(this.getIndexByXY(a+1,s+2)),this.casillaDisponible(a-1,s+2,t,i)&&n.push(this.getIndexByXY(a-1,s+2)),this.casillaDisponible(a+2,s+1,t,i)&&n.push(this.getIndexByXY(a+2,s+1)),this.casillaDisponible(a+2,s-1,t,i)&&n.push(this.getIndexByXY(a+2,s-1)),this.casillaDisponible(a-2,s+1,t,i)&&n.push(this.getIndexByXY(a-2,s+1)),this.casillaDisponible(a-2,s-1,t,i)&&n.push(this.getIndexByXY(a-2,s-1)),this.casillaDisponible(a+1,s-2,t,i)&&n.push(this.getIndexByXY(a+1,s-2)),this.casillaDisponible(a-1,s-2,t,i)&&n.push(this.getIndexByXY(a-1,s-2)),n}movimientosPeonSeleccionado(e,t,i,a){const{x:s,y:n}=this.getXYByIndex(a.get(e).casillaIndex),o=[];if(o.push(...this.movimientosPeon(e,t,i,a)),t){if(1==n){for(let e=n+1;e<=3&&this.casillaVacia(this.getIndexByXY(s,e),i);e++)o.push(this.getIndexByXY(s,e));return o}this.casillaVacia(this.getIndexByXY(s,n+1),i)&&o.push(this.getIndexByXY(s,n+1))}else{if(6==n){for(let e=n-1;e>=4&&this.casillaVacia(this.getIndexByXY(s,e),i);e--)o.push(this.getIndexByXY(s,e));return o}this.casillaVacia(this.getIndexByXY(s,n-1),i)&&o.push(this.getIndexByXY(s,n-1))}if(this.peonPasoCasilla&&(a.get(e).casillaIndex===this.peonPasoCasilla-1||a.get(e).casillaIndex===this.peonPasoCasilla+1)){const{x:e,y:i}=this.getXYByIndex(this.peonPasoCasilla);o.push(this.getIndexByXY(e,t?i+1:i-1))}return o}movimientosPeon(e,t,i,a){const{x:s,y:n}=this.getXYByIndex(a.get(e).casillaIndex),o=[];let c=s-1,r=t?n+1:n-1;return this.isValidCoord(c,r)&&!this.casillaVacia(this.getIndexByXY(c,r),i)&&(t?i[this.getIndexByXY(c,r)]>=17:i[this.getIndexByXY(c,r)]<=16)&&o.push(this.getIndexByXY(c,r)),c=s+1,r=t?n+1:n-1,this.isValidCoord(c,r)&&!this.casillaVacia(this.getIndexByXY(c,r),i)&&(t?i[this.getIndexByXY(c,r)]>=17:i[this.getIndexByXY(c,r)]<=16)&&o.push(this.getIndexByXY(c,r)),o}cargarAreaJugador(e,t,i){const a=[];let s=1,n=16;e||(s=17,n=32);for(let o=s;o<=n;o++)i.has(o)&&a.push(...this.movimientosValidos(o,e,t,i));return[...new Set(a)]}coronarPeon(e,t){this.matDialog.open($,{hasBackdrop:!0,disableClose:!0,data:this.soyBlancas}).afterClosed().subscribe(i=>{const a=this.piezasPartidaEstado.get(this.casillas[e]);let s;switch(a.tipo=i,a.unicode=this.piezaImagen(i,this.soyBlancas),i){case c.a.ALFIL:s="B";break;case c.a.CABALLO:s="N";break;case c.a.REINA:s="Q";break;case c.a.TORRE:s="R"}this.validarJaquemate({tipo:o.a.CORONADO,movimiento:{casillaDestino:e,piezaId:this.casillas[e],tiempoDemora:Date.now()-this.inicioMovimiento,notacionAlg:t+"="+s,tiempoRestante:this.miTiempoRestante},coronadoPieza:i})})}isValidCoord(e,t){return null!=this.indexMap.get(`${e}${t}`)}coordsRango(e,t){return e>=0&&e<8&&t>=0&&t<8}casillaNegra(e,t){return t%2==0&&e%2==0||t%2!=0&&e%2!=0}getUnicode(e){return this.piezasPartidaEstado.get(e).unicode}piezaImagen(e,t){switch(e){case c.a.REY:return t?"\u2654":"\u265a";case c.a.REINA:return t?"\u2655":"\u265b";case c.a.TORRE:return t?"\u2656":"\u265c";case c.a.ALFIL:return t?"\u2657":"\u265d";case c.a.CABALLO:return t?"\u2658":"\u265e";case c.a.PEON:return t?"\u2659":"\u265f\ufe0e"}}inicializarPiezas(){this.piezasPartidaEstado=new Map([[1,{casillaIndex:0,tipo:c.a.TORRE,unicode:this.piezaImagen(c.a.TORRE,!0)}],[2,{casillaIndex:1,tipo:c.a.CABALLO,unicode:this.piezaImagen(c.a.CABALLO,!0)}],[3,{casillaIndex:2,tipo:c.a.ALFIL,unicode:this.piezaImagen(c.a.ALFIL,!0)}],[4,{casillaIndex:3,tipo:c.a.REINA,unicode:this.piezaImagen(c.a.REINA,!0)}],[5,{casillaIndex:4,tipo:c.a.REY,unicode:this.piezaImagen(c.a.REY,!0)}],[6,{casillaIndex:5,tipo:c.a.ALFIL,unicode:this.piezaImagen(c.a.ALFIL,!0)}],[7,{casillaIndex:6,tipo:c.a.CABALLO,unicode:this.piezaImagen(c.a.CABALLO,!0)}],[8,{casillaIndex:7,tipo:c.a.TORRE,unicode:this.piezaImagen(c.a.TORRE,!0)}],[9,{casillaIndex:8,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[10,{casillaIndex:9,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[11,{casillaIndex:10,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[12,{casillaIndex:11,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[13,{casillaIndex:12,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[14,{casillaIndex:13,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[15,{casillaIndex:14,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[16,{casillaIndex:15,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!0)}],[17,{casillaIndex:48,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[18,{casillaIndex:49,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[19,{casillaIndex:50,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[20,{casillaIndex:51,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[21,{casillaIndex:52,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[22,{casillaIndex:53,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[23,{casillaIndex:54,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[24,{casillaIndex:55,tipo:c.a.PEON,unicode:this.piezaImagen(c.a.PEON,!1)}],[25,{casillaIndex:56,tipo:c.a.TORRE,unicode:this.piezaImagen(c.a.TORRE,!1)}],[26,{casillaIndex:57,tipo:c.a.CABALLO,unicode:this.piezaImagen(c.a.CABALLO,!1)}],[27,{casillaIndex:58,tipo:c.a.ALFIL,unicode:this.piezaImagen(c.a.ALFIL,!1)}],[28,{casillaIndex:59,tipo:c.a.REINA,unicode:this.piezaImagen(c.a.REINA,!1)}],[29,{casillaIndex:60,tipo:c.a.REY,unicode:this.piezaImagen(c.a.REY,!1)}],[30,{casillaIndex:61,tipo:c.a.ALFIL,unicode:this.piezaImagen(c.a.ALFIL,!1)}],[31,{casillaIndex:62,tipo:c.a.CABALLO,unicode:this.piezaImagen(c.a.CABALLO,!1)}],[32,{casillaIndex:63,tipo:c.a.TORRE,unicode:this.piezaImagen(c.a.TORRE,!1)}]]),this.casillas=new Array(64).fill(null,0,64),this.casillasPosibles=new Array(64).fill(!1,0,64),this.piezasPartidaEstado.forEach((e,t)=>this.casillas[e.casillaIndex]=t),this.piezaSeleccionada=null}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(d.a),h.Lb(ge.c),h.Lb(l.b),h.Lb(m.a))},e.\u0275cmp=h.Fb({type:e,selectors:[["app-partida"]],decls:14,vars:7,consts:[[2,"text-align","center"],[1,"letraBlanca",2,"display","inline-block"],[4,"ngFor","ngForOf"],["mat-raised-button","",1,"btnAzul",2,"display","inline-block","margin-left","10px","margin-right","auto",3,"disabled","click"],[1,"mat-18"],["mat-raised-button","","class","btnAzul","style","display: inline-block; margin-left: 10px; margin-right: auto;",3,"disabled","click",4,"ngIf"],["mat-raised-button","","class","btnAzul","style","display: inline-block; margin-left: 10px; margin-right: auto;",3,"click",4,"ngIf"],[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],["class","pieza",3,"ngClass",4,"ngIf"],[1,"pieza",3,"ngClass"],["mat-raised-button","",1,"btnAzul",2,"display","inline-block","margin-left","10px","margin-right","auto",3,"click"]],template:function(e,t){1&e&&(h.Rb(0,"div",0),h.Rb(1,"p",1),h.yc(2),h.Qb(),h.Qb(),h.Rb(3,"table"),h.xc(4,ye,2,1,"tr",2),h.Qb(),h.Rb(5,"div",0),h.Rb(6,"p",1),h.yc(7),h.Qb(),h.Rb(8,"button",3),h.Yb("click",function(){return t.rendirme()}),h.yc(9," Rendirce "),h.Rb(10,"mat-icon",4),h.yc(11,"flag"),h.Qb(),h.Qb(),h.xc(12,ve,4,1,"button",5),h.xc(13,Re,4,0,"button",6),h.Qb()),2&e&&(h.Ab(2),h.Bc(" ",t.getContricanteName()," \u23f3 ",t.timepoRestante(t.tiempoRestanteContricante)," "),h.Ab(2),h.ic("ngForOf",t.orientacionRows),h.Ab(3),h.Ac(" \u23f3 ",t.timepoRestante(t.miTiempoRestante),""),h.Ab(1),h.ic("disabled",!t.miTurno),h.Ab(4),h.ic("ngIf",null===t.tablasStatus),h.Ab(1),h.ic("ngIf",t.tablasStatus))},directives:[a.k,p.a,N.a,a.l,a.j],styles:[".casillaNegra[_ngcontent-%COMP%]{background:grey}.piezaSeleccionada[_ngcontent-%COMP%]{border-color:#fbff00}.piezaPropia[_ngcontent-%COMP%]{cursor:pointer}.movimientos[_ngcontent-%COMP%]{filter:drop-shadow(0 0 0 #fcff2f)!important}.areaEnemigo[_ngcontent-%COMP%]{background:rgba(255,0,0,.3137254901960784)}table[_ngcontent-%COMP%]{border-collapse:collapse;border:1px solid #000;animation:randomColors 1s infinite}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]:nth-child(odd), tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]:nth-child(2n){background:radial-gradient(#fff,hsla(0,0%,100%,.47843137254901963))}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]:nth-child(odd), tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]:nth-child(2n){background:radial-gradient(#5bbbff,rgba(0,0,0,.47843137254901963))}@keyframes randomColors{0%{border-color:red}25%{border-color:#00f}50%{border-color:green}75%{border-color:#ff0}to{border-color:purple}}.pieza[_ngcontent-%COMP%]{font-size:37px;margin:0;padding:0;text-align:center;width:auto;height:auto;-webkit-user-select:none;user-select:none}table[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]{width:50px;height:50px;white-space:nowrap}@media screen and (min-width:500px){table[_ngcontent-%COMP%]{width:500px;height:500px;margin-right:auto;margin-left:auto}}@media screen and (max-width:500px){table[_ngcontent-%COMP%]{width:100%;height:auto}}[_nghost-%COMP%]{display:block;background:#81b0c3;height:100%;overflow:auto}.letraBlanca[_ngcontent-%COMP%]{color:#142857;font-weight:700}"]}),e})();var Ae=i("Wp6s"),Ce=i("zHaW");const Ee=[{path:"",component:_e}];let Pe=(()=>{class e{}return e.\u0275mod=h.Jb({type:e}),e.\u0275inj=h.Ib({factory:function(t){return new(t||e)},imports:[[a.b,ge.e.forChild(Ee),Ae.c,l.d,p.b,N.b,Ce.b,D,r.n,S.d,X.b,de]]}),e})()}}]);